name: CI

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  validate:
    name: Validate YAML files
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Validate Kubernetes manifests
        run: |
          # Check if yq is available, otherwise skip
          if command -v yq &> /dev/null; then
            echo "Validating YAML files..."
            find . -name "*.yaml" -o -name "*.yml" | while read file; do
              yq eval '.' "$file" > /dev/null 2>&1 || echo "Warning: $file may have YAML syntax issues"
            done
          else
            echo "yq not available, skipping YAML validation"
          fi
      
      - name: Check for common issues
        run: |
          echo "Checking for common issues..."
          # Check if go.mod and go.sum are in sync (basic check)
          if [ -f "go.mod" ] && [ -f "go.sum" ]; then
            echo "✓ go.mod and go.sum found"
          fi
          # Check if Helm chart exists
          if [ -d "helm/node-check-operator" ]; then
            echo "✓ Helm chart found"
          fi

